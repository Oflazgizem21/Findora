{% load static %}
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaybettim</title>
    <link rel="stylesheet" href="{% static 'css/kaybettim.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>
<body>
    <div class="container">
        <a href="javascript:history.back()" class="back-button">
            <i class="fas fa-chevron-left"></i>
        </a>

        <h1 class="animate__animated animate__fadeInDown">Kaybettim</h1>

        <form method="post" enctype="multipart/form-data" class="form">
            {% csrf_token %}

            <!-- EÅŸya TanÄ±mÄ± -->
            <div class="form-group">
                <label for="id_description"><i class="fas fa-pencil-alt"></i> EÅŸya TanÄ±mÄ±:</label>
                {{ form.tanim }}
            </div>

            <!-- EÅŸya TÃ¼rÃ¼ -->
            <div class="form-group">
                <label for="id_tur"><i class="fas fa-tag"></i> EÅŸya TÃ¼rÃ¼:</label>
                <select id="id_tur" name="tur" class="form-select" onchange="toggleCustomInput('tur')">
                    <option value="" selected disabled>SeÃ§iniz...</option>
                    {% for value, label in form.tur.field.choices %}
                        <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                </select>
                <div id="custom_tur_box" style="display:none; margin-top: 10px;">
                    <input type="text" id="id_custom_tur" name="custom_tur" class="form-input" placeholder="Ã–rnek: Kemer, GÃ¶zlÃ¼k...">
                </div>
            </div>

            <!-- Renk -->
            <div class="form-group">
                <label for="id_renk"><i class="fas fa-palette"></i> EÅŸya Rengi:</label>
                <select id="id_renk" name="renk" class="form-select" onchange="toggleCustomInput('renk')">
                    <option value="" selected disabled>SeÃ§iniz...</option>
                    {% for value, label in form.renk.field.choices %}
                        <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                </select>
                <div id="custom_renk_box" style="display:none; margin-top: 10px;">
                    <input type="text" id="id_custom_renk" name="custom_renk" class="form-input" placeholder="Ã–rnek: Kahverengi, AslanaÄŸzÄ±...">
                </div>
            </div>

            <!-- Konum -->
            <div class="form-group">
                <label for="id_location"><i class="fas fa-map-marker-alt"></i> Konum:</label>
                {{ form.konum }}
            </div>

            <!-- Resim -->
            <div class="form-group file-input-container">
                <label for="id_resim" class="custom-file-label">
                 <i class="fas fa-file-arrow-down"></i> Dosya SeÃ§
                 </label>
                {{ form.resim }}
                <span>KaybettiÄŸiniz eÅŸyanÄ±n resmini buraya yÃ¼kleyiniz..</span>
                <div id="previewContainer" style="display: none; text-align: center;">
                 <img id="previewImage" style="margin: 1rem auto 0 auto; display: block; max-width: 150px; border-radius: 8px;" />
                 </div>
            </div>
             

            <button type="submit" class="btn animate__animated animate__pulse animate__infinite animate__slower">
                <i class="fas fa-save"></i> Kaydet
            </button>
        </form>
    </div>

    <script>
        function toggleCustomInput(field) {
            const select = document.getElementById(`id_${field}`);
            const customBox = document.getElementById(`custom_${field}_box`);

            if (select.value === 'diger') {
                customBox.style.display = 'block';
                customBox.querySelector('input').focus();
                customBox.classList.add('animate__animated', 'animate__fadeIn');
            } else {
                customBox.style.display = 'none';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            toggleCustomInput('tur');
            toggleCustomInput('renk');

            // Animasyonlu inputlar
            const inputs = document.querySelectorAll('input, select');
            inputs.forEach(input => {
                input.addEventListener('focus', () => {
                    input.parentElement.classList.add('animate__animated', 'animate__pulse');
                });
                input.addEventListener('blur', () => {
                    input.parentElement.classList.remove('animate__animated', 'animate__pulse');
                });
            });

            // Dosya etiketi
            const fileInput = document.querySelector('input[type="file"]');
            const fileLabel = document.querySelector('.custom-file-label');

            if (fileInput) {
                fileInput.addEventListener('change', function () {
                    if (this.files.length > 0) {
                        const fileName = this.files[0].name;
                        fileLabel.innerHTML = `<i class="fas fa-check-circle"></i> ${fileName}`;
                        fileLabel.style.color = '#20c997';
                        fileLabel.classList.add('animate__animated', 'animate__bounceIn');
                        setTimeout(() => fileLabel.classList.remove('animate__animated', 'animate__bounceIn'), 1000);
                
                        // ðŸ”½ BurasÄ± gÃ¶rsel Ã¶nizleme kÄ±smÄ± ðŸ”½
                        if (this.files && this.files[0]) {
                            const reader = new FileReader();
                            reader.onload = function (e) {
                                const previewImage = document.getElementById('previewImage');
                                const previewContainer = document.getElementById('previewContainer');
                
                                previewImage.src = e.target.result;
                                previewContainer.style.display = 'block';
                            };
                            reader.readAsDataURL(this.files[0]);
                        }
                
                    } else {
                        fileLabel.innerHTML = `<i class="fas fa-file-arrow-down"></i> Dosya SeÃ§`;
                        fileLabel.style.color = '';
                        document.getElementById('previewContainer').style.display = 'none';
                    }
                });
                
            }
        });
    </script>
</body>
</html>
